{
  "channel": "process_creation",
  "description": "Detects renamed Visual Studio Code tunnel execution. Attackers can abuse this functionality to establish a C2 channel",
  "fields": {
    "selection_parent_tunnel": {
      "ParentCommandLine|endswith": " tunnel",
      "Image|endswith": "\\cmd.exe",
      "CommandLine|contains|all": [
        "/d /c ",
        "\\servers\\Stable-",
        "code-server.cmd"
      ]
    }
  },
  "fieldguidance": {
    "selection_parent_tunnel": {
      "ParentCommandLine ends with": [
        " tunnel"
      ],
      "Image ends with": [
        "\\cmd.exe"
      ],
      "CommandLine contains all of": [
        "/d /c ",
        "\\servers\\Stable-",
        "code-server.cmd"
      ]
    }
  },
  "message": "Executable loaded: \\cmd.exe | Command executed: /d /c , \\servers\\Stable- | ",
  "condition": "selection_parent_tunnel"
}